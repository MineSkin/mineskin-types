{"version":3,"file":"MicrosoftAuthInfo.js","sourceRoot":"/","sources":["auth/MicrosoftAuthInfo.ts"],"names":[],"mappings":"","sourcesContent":["\r\n\r\ninterface Expiring {\r\n    expires: number;\r\n    issued: number;\r\n}\r\n\r\nexport interface XboxInfo {\r\n    mcAccessToken?: string;\r\n    msa?: MicrosoftAuthInfo;\r\n}\r\n\r\nexport interface MicrosoftAuthInfo {\r\n    auth: MicrosoftAuthResponse;\r\n    userToken: UserTokenResponse;\r\n    identities: {\r\n        mc: IdentityResponse;\r\n        xbox: IdentityResponse;\r\n    }\r\n}\r\n\r\n/*\r\n>>>\r\nPOST https://login.live.com/oauth20_token.srf\r\n\r\n<<<\r\n {\r\n   \"token_type\":\"bearer\",\r\n   \"expires_in\":86400,\r\n   \"scope\":\"XboxLive.signin\",\r\n   \"access_token\":\"token here\",\r\n   \"refresh_token\":\"M.R3_BAY.token here\",\r\n   \"user_id\":\"889ed4a3d844f672\",\r\n   \"foci\":\"1\"\r\n }\r\n */\r\nexport interface MicrosoftAuthResponse extends Expiring {\r\n    accessToken: string;\r\n    refreshToken: string;\r\n    userId: string;\r\n}\r\n\r\n/*\r\n>>>\r\nPOST https://user.auth.xboxlive.com/user/authenticate\r\n {\r\n    \"Properties\": {\r\n        \"AuthMethod\": \"RPS\",\r\n        \"SiteName\": \"user.auth.xboxlive.com\",\r\n        \"RpsTicket\": \"d=<access token>\" // your access token from step 2 here\r\n    },\r\n    \"RelyingParty\": \"http://auth.xboxlive.com\",\r\n    \"TokenType\": \"JWT\"\r\n }\r\n\r\n<<<\r\n{\r\n   \"IssueInstant\":\"2020-12-07T19:52:08.4463796Z\",\r\n   \"NotAfter\":\"2020-12-21T19:52:08.4463796Z\",\r\n   \"Token\":\"token\", // save this, this is your xbl token\r\n   \"DisplayClaims\":{\r\n      \"xui\":[\r\n         {\r\n            \"uhs\":\"userhash\" // save this\r\n         }\r\n      ]\r\n   }\r\n }\r\n */\r\nexport interface UserTokenResponse extends Expiring {\r\n    token: string;\r\n    userHash: string;\r\n}\r\n\r\n/*\r\n>>>\r\n POST https://xsts.auth.xboxlive.com/xsts/authorize\r\n {\r\n    \"Properties\": {\r\n        \"SandboxId\": \"RETAIL\",\r\n        \"UserTokens\": [\r\n            \"xbl_token\" // from above\r\n        ]\r\n    },\r\n    \"RelyingParty\": \"rp://api.minecraftservices.com/\",\r\n    \"TokenType\": \"JWT\"\r\n }\r\n\r\n <<<\r\n  {\r\n   \"IssueInstant\":\"2020-12-07T19:52:09.2345095Z\",\r\n   \"NotAfter\":\"2020-12-08T11:52:09.2345095Z\",\r\n   \"Token\":\"token\", // save this, this is your xsts token\r\n   \"DisplayClaims\":{\r\n      \"xui\":[\r\n         {\r\n            \"uhs\":\"userhash\" // same as last request\r\n         }\r\n      ]\r\n   }\r\n}\r\n */\r\nexport interface IdentityResponse extends Expiring {\r\n    token: string;\r\n    claims: {\r\n        [claim: string]: any;\r\n    }\r\n}\r\n\r\n\r\n\r\nexport interface XboxLoginResponse {\r\n    username: string;\r\n    access_token: string;\r\n    expires_in: number;\r\n}\r\n\r\nexport interface XSTSResponse {\r\n    IssueInstant: string;\r\n    NotAfter: string;\r\n    Token: string;\r\n    DisplayClaims: {\r\n        xui: [\r\n            {\r\n                uhs: string;\r\n                [claim: string]: any;\r\n            }\r\n        ]\r\n    }\r\n}\r\n\r\nexport interface MicrosoftIdentities {\r\n    xbox: XSTSResponse;\r\n    mc: XSTSResponse;\r\n}\r\n\r\nexport interface MicrosoftOauthResult {\r\n    user: string;\r\n    email: string;\r\n    microsoftInfo: XboxInfo;\r\n}\r\n\r\nexport interface SessionMicrosoftInfo {\r\n    account: {\r\n        user: string; // mineskin user id\r\n        email: string;\r\n    };\r\n    auth: {\r\n        microsoftInfo: XboxInfo;\r\n        tokenHash: string;\r\n        msaHash: string;\r\n    };\r\n}\r\n"]}